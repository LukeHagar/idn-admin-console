import{s as I,f as h,a as T,g,h as C,S as V,c as q,d,j as y,i as w,A as b,o as A,z as M}from"../chunks/scheduler.10bc074a.js";import{S as O,i as P,t as $,c as R,a as k,g as L,b as E,d as D,m as N,e as j}from"../chunks/index.7b3d626a.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.ae9fcbec.js";import{t as x,P as z,T as J}from"../chunks/Table.f5db4492.js";import{a as F}from"../chunks/alasql.min.1f65b74d.js";function B(u){let t,n,e;return n=new z({props:{stroke:100,meter:"stroke-primary-500",track:"stroke-primary-500/30",class:"progress-bar"}}),{c(){t=h("div"),E(n.$$.fragment),this.h()},l(s){t=g(s,"DIV",{class:!0});var l=C(t);D(n.$$.fragment,l),l.forEach(d),this.h()},h(){y(t,"class","progress-bar svelte-sfm816")},m(s,l){w(s,t,l),N(n,t,null),e=!0},p:M,i(s){e||(k(n.$$.fragment,s),e=!0)},o(s){$(n.$$.fragment,s),e=!1},d(s){s&&d(t),j(n)}}}function G(u){let t,n;return t=new J({props:{class:"w-full",source:u[0],interactive:!0}}),t.$on("selected",K),{c(){E(t.$$.fragment)},l(e){D(t.$$.fragment,e)},m(e,s){N(t,e,s),n=!0},p(e,s){const l={};s&1&&(l.source=e[0]),t.$set(l)},i(e){n||(k(t.$$.fragment,e),n=!0)},o(e){$(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function H(u){let t,n,e,s,l="Listing of identities that are inactive but still have access in sources",p,o,a,c;const _=[G,B],i=[];function S(r,m){return r[0]?0:1}return o=S(u),a=i[o]=_[o](u),{c(){t=h("main"),n=h("div"),e=h("div"),s=h("div"),s.textContent=l,p=T(),a.c(),this.h()},l(r){t=g(r,"MAIN",{});var m=C(t);n=g(m,"DIV",{class:!0});var f=C(n);e=g(f,"DIV",{class:!0});var v=C(e);s=g(v,"DIV",{class:!0,"data-svelte-h":!0}),V(s)!=="svelte-1wbzyk2"&&(s.textContent=l),p=q(v),a.l(v),v.forEach(d),f.forEach(d),m.forEach(d),this.h()},h(){y(s,"class","text-2xl py-2 text-center"),y(e,"class","flex justify-center mt-4 flex-col align-middle"),y(n,"class","p-4")},m(r,m){w(r,t,m),b(t,n),b(n,e),b(e,s),b(e,p),i[o].m(e,null),c=!0},p(r,[m]){let f=o;o=S(r),o===f?i[o].p(r,m):(L(),$(i[f],1,1,()=>{i[f]=null}),R(),a=i[o],a?a.p(r,m):(a=i[o]=_[o](r),a.c()),k(a,1),a.m(e,null))},i(r){c||(k(a),c=!0)},o(r){$(a),c=!1},d(r){r&&d(t),i[o].d()}}}function K(u){console.log(u)}function Q(u,t,n){let e;return A(async()=>{let p=await(await fetch("/api/sailpoint/search",{method:"POST",body:JSON.stringify({indices:["identities"],query:{query:"@accounts(disabled:false) AND (attributes.cloudLifecycleState:inactive)"},sort:["name"]}),headers:{"content-type":"application/json"}})).json();if(console.log(p),JSON.stringify(p)!=="{}"){let o=[];for(let c of p){let _=[];for(let i of c.accounts)i.disabled==!1&&_.push(i.source.name);o.push({name:c.displayName,source:_.join(", "),department:c.attributes.department,accessCount:c.accessCount,entitlementCount:c.entitlementCount,roleCount:c.roleCount})}let a=F("SELECT name, source, department, accessCount, entitlementCount, roleCount FROM ?",[o]);console.log(a),n(0,e={head:["Name","Sources","Departments","Access Count","Entitlement Count","Role Count"],body:x(a,["name","source","department","accessCount","entitlementCount","roleCount"]),meta:x(a,["name","source","department","accessCount","entitlementCount","roleCount"])})}}),[e]}class ee extends O{constructor(t){super(),P(this,t,Q,H,I,{})}}export{ee as component};
